<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      th:replace="~{layout/user-layout :: content(~{::section})}">

<section>
    <!-- ใช้ Card ของ Bootstrap เพื่อจัดกรอบเนื้อหาให้สวยงาม -->
    <div class="card shadow-sm">
        <div class="card-header bg-white">
            <h3 class="card-title d-flex align-items-center mb-0">
                <i class="fas fa-history me-2"></i> <!-- เพิ่มไอคอน -->
                ประวัติการยืมหนังสือ
            </h3>
        </div>
        <div class="card-body">
            <!-- ทำให้ตารางรองรับการแสดงผลบนมือถือ (Responsive) -->
            <div class="table-responsive">
                <table class="table table-striped table-hover align-middle">
                    <!-- ใช้ aign-middle เพื่อจัดให้เนื้อหาอยู่กึ่งกลางแนวตั้ง -->
                    <thead class="table-dark">
                        <tr>
                            <th scope="col">หนังสือ</th>
                            <th scope="col" class="text-center">จำนวน</th>
                            <th scope="col">วันยืมหนังสือ</th>
                            <th scope="col">วันคืนหนังสือ</th>
                            <th scope="col" class="text-center">สถานะ</th>
                            <th scope="col" class="text-end">ค่าปรับ</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- กรณีไม่มีข้อมูล -->
                        <tr th:if="${#lists.isEmpty(borrowHistory)}">
                            <td colspan="6" class="text-center text-muted py-4">
                                <h5>คุณไม่มีประวัติการยืม</h5>
                            </td>
                        </tr>
                        
                        <!-- วนลูปแสดงข้อมูล -->
                        <tr th:each="b : ${borrowHistory}">
                            <td th:text="${b.book.title}">Title</td>
                            <td class="text-center" th:text="${b.quantity}">1</td>
                            <td th:text="${#temporals.format(b.borrowDate, 'dd-MM-yyyy HH:mm')}">Date</td>
                            
                            <!-- วันที่คืน -->
                            <td th:text="${b.returnDate != null} ? ${#temporals.format(b.returnDate, 'dd-MM-yyyy HH:mm')} : '- ยังไม่คืน -'">Date</td>

                            <!-- สถานะ (ใช้ Badges เพื่อความสวยงาม) -->
                            <td class="text-center">
                                <span th:if="${b.returned}" class="badge bg-success">คืนแล้ว</span>
                                <span th:unless="${b.returned}" class="badge bg-warning text-dark">ยังไม่คืน</span>
                            </td>

                            <!-- ค่าปรับ -->
                            <td class="text-end" th:classappend="${b.fine > 0} ? 'text-danger fw-bold' : ''">
                                <span th:text="${#numbers.formatDecimal(b.fine, 1, 'COMMA', 2, 'POINT')}">0.00</span> บาท
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</section>

</html>